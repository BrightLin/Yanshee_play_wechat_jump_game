#!/usr/bin/python# -*- coding: utf-8 -*-import osimport timeimport socketimport threadingfrom ctypes import *from ubtinit import *        def sendmsg(ADDR,buf):#-------- send udp msg ---------------------    udpclientSock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)    udpclientSock.sendto(buf, ADDR)    udpclientSock.close()    def initserver(port):#-------udp server function------------------    socket_fd = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)    socket_fd.setsockopt(socket.SOL_SOCKET,socket.SO_REUSEADDR, 1)    socket_fd.bind(("",port))    return socket_fddef report(name):#-------report run status function--------        api.ubtReportStatusToApp(name, "start")	while True:		time.sleep(3)		api.ubtReportStatusToApp(name, "run")def reportstatus(name):#-------report run status thread --------    th = threading.Thread(target=report, args=(name,))    th.setDaemon(True)    th.start()def commwithrobot(name,addr,fd):#---------communicate wiht robot function---        sendmsg(addr,"start")        while True:                data,clientaddr = fd.recvfrom(512)                print data, "from", clientaddr                try:                        if data == b'stop':                                stop(name,addr[0])                                sendmsg(addr,"stop")                                break                except Exception,e:                        print "error occur:\t",repr(e)        fd.close()        os._exit(0)def processmessage(name,addr,server_socket):#-------process mssage thread --------    th = threading.Thread(target=commwithrobot, args=(name,addr,server_socket))    th.setDaemon(True)    th.start()